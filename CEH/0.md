
# 7.Malware

### 1. Trojans
  ##### Remote Access Trojans (RATs)
  - build by "njRAT"
  
  ##### Hide a Trojan
  - FUDs(fully undetectable crypters)
  - using **SwayzCryptor**
    - test by https://www.virustotal.com after hiding
  ##### Create a server
  - by **ProRat**
    - written in C
    - allow users to control computers remotely
  - by **Theef RAT Trojan**
    - written in Delphi

### 2. Virus
  ##### Create a Virus
    - by **JPS Virus Maker**
    
### 3. Static Malware Analysis
  
  ###### Online Malware Scanning
  
  - **VirusTotal**
    - https://www.virustotal.com
  - Hybrid Analysis (https://www.hybrid-analysis.com)
  - Cuckoo Sandbox (https://cuckoosandbox.org)
  - Jotti (https://virusscan.jotti.org)
  - Valkyrie Sandbox (https://valkyrie.comodo.com)
  
  ##### String Search
  
  - ```Various strings that could represent the malicious intent of a program```
  - FLOSS (https://www.fireeye.com)
  - Strings (https://docs.microsoft.com)
  - Free EXE DLL Resource Extract (http://www.resourceextract.com)
  - FileSeek (https://www.fileseek.ca)
  
  ##### Identify packaging and obfuscation
  
  - ``` Attackers often use packing and obfuscation or a packer to compress, encrypt, or modify a malware executable file to avoid detection. ```
  - ``` When the user executes a packed program, it also runs a small wrapper program to decompress the packed file, and then runs the unpacked file. ```
  - **PEid**
    - on Windows, can identify signatures associated with over 600 different packers and compilers.
  - Macro_Pack (https://github.com)
  - UPX (https://upx.github.io)
  - ASPack (http://www.aspack.com)

  ##### Portable Executable (PE) Information
  
  - PE Explorer
    - PE Explorer gives you the power to look inside these PE binary files, perform static analysis, reveal a lot of information about the function of the executable, and collect as much information about the executable file as possible, without executing it.
  - Portable Executable Scanner (pescan) (https://tzworks.net)
  - Resource Hacker (http://www.angusj.com)
  - PEView (https://www.aldeid.com)

  ##### Identify file dependencies
  - dlls
    - **Kernel32.dll** Core functionality such as access and manipulation of memory, files and hardware.
    - **Advapi32.dll** Provides access to advanced core Windows components such as the Service Manager and Registry.
    - **User32.dll User** interface components such as buttons, scrollbars and components for controlling and responding to user actions.
    - **Gdi32.dll** Functions for displaying and manipulating graphics.
    - **Ntdll.dll** Interface to the windows kernel.
    - **WSock32.dll & Ws2_32.dll** Networking DLLs help to connect to a network or network related tasks.
    - **Wininet.dll** Supports higher-level networking functions.
  
  - Dependency Walker
    - ``` The Dependency Walker tool lists all dependent modules of an executable file and builds hierarchical tree diagrams. ```
  - Dependency-check (https://jeremylong.github.io)
  - Snyk (https://snyk.io)
  - Hakiri (https://hakiri.io)
  - RetireJS (https://retirejs.github.io)

  ##### Malware Disassembly
  - IDA
  - OllyDbg
  - Ghirda (https://ghidra-sre.org)
  - Radare2 (https://rada.re)
  - WinDbg (http://www.windbg.org)
  - ProcDump (https://docs.microsoft.com)

